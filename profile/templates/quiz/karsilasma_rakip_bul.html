{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    :root {
        --primary-purple: #7B68EE;
        --dark-purple: #6A5ACD;
        --accent-orange: #FF8C00;
    }
    
    body {
        background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
        font-family: 'Nunito', sans-serif;
        color: white;
        min-height: 100vh;
    }
    
    .lobby-container {
        max-width: 800px;
        margin: 80px auto;
        text-align: center;
        animation: fadeIn 0.8s ease-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .lobby-card {
        background: white;
        color: #333;
        border-radius: 30px;
        padding: 60px 40px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .lobby-title {
        font-size: 3.5rem;
        font-weight: 900;
        color: var(--dark-purple);
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    
    .lobby-subtitle {
        font-size: 1.3rem;
        color: #6c757d;
        margin-bottom: 40px;
    }
    
    .loading-animation {
        position: relative;
        width: 150px;
        height: 150px;
        margin: 40px auto;
    }
    
    .spinner {
        width: 150px;
        height: 150px;
        border: 8px solid #f3f3f3;
        border-top: 8px solid var(--primary-purple);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .search-text {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dark-purple);
        margin-top: 30px;
        animation: pulse 1.5s ease-in-out infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    
    .info-box {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 20px;
        padding: 30px;
        margin-top: 40px;
        text-align: left;
    }
    
    .info-box h5 {
        color: var(--dark-purple);
        font-weight: 800;
        margin-bottom: 20px;
    }
    
    .info-box ul {
        list-style: none;
        padding: 0;
    }
    
    .info-box li {
        padding: 12px 0;
        border-bottom: 1px solid #dee2e6;
        color: #495057;
        font-weight: 600;
    }
    
    .info-box li:last-child {
        border-bottom: none;
    }
    
    .info-box li i {
        color: var(--accent-orange);
        margin-right: 12px;
        font-size: 1.2rem;
    }
    
    .btn-cancel {
        margin-top: 30px;
        padding: 15px 40px;
        font-size: 1.2rem;
        font-weight: 700;
        border-radius: 50px;
        background: #6c757d;
        border: none;
        color: white;
        transition: all 0.3s ease;
    }
    
    .btn-cancel:hover {
        background: #5a6268;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    
    @media (max-width: 768px) {
        .lobby-title {
            font-size: 2.5rem;
        }
        
        .lobby-card {
            padding: 40px 20px;
        }
    }
</style>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

<div class="lobby-container">
    <div class="lobby-card">
        <h1 class="lobby-title">
            <i class="bi bi-lightning-charge-fill"></i> KARŞILAŞMA
        </h1>
        <p class="lobby-subtitle">Rakip aranıyor, hazır ol!</p>
        
        <div class="loading-animation">
            <div class="spinner"></div>
        </div>
        
        <p class="search-text">
            <i class="bi bi-search"></i> Rakip aranıyor...
        </p>
        
        <div class="info-box">
            <h5><i class="bi bi-info-circle-fill"></i> Nasıl Çalışır?</h5>
            <ul>
                <li>
                    <i class="bi bi-people-fill"></i>
                    Sistem seni uygun bir rakiple eşleştirecek
                </li>
                <li>
                    <i class="bi bi-stopwatch-fill"></i>
                    5 YKS sorusu çözeceksiniz
                </li>
                <li>
                    <i class="bi bi-trophy-fill"></i>
                    En çok doğru yapan kazanır!
                </li>
                <li>
                    <i class="bi bi-star-fill"></i>
                    Puan kazan, liderlik tablosunda yüksel
                </li>
            </ul>
        </div>
        
        <a href="{% url 'profil' %}" class="btn btn-cancel">
            <i class="bi bi-x-circle"></i> İptal Et
        </a>
    </div>
</div>

<script>
    let refreshCount = 0;
    const maxRefresh = 20; // 1 dakika (3 saniye x 20)
    
    function checkForMatch() {
        refreshCount++;
        
        if (refreshCount >= maxRefresh) {
            // 1 dakika sonra hala eşleşme yoksa
            document.querySelector('.search-text').innerHTML = '<i class="bi bi-exclamation-circle"></i> Rakip bulunamadı!';
            document.querySelector('.btn-cancel').innerHTML = '<i class="bi bi-arrow-left"></i> Geri Dön';
            return;
        }
        
        // Sayfa yenileniyor - rakip kontrolü
        location.reload();
    }
    
    // Her 3 saniyede bir kontrol et
    setTimeout(checkForMatch, 3000);
    
    // Sayfa başlığını güncelle
    let dots = 0;
    setInterval(function() {
        dots = (dots + 1) % 4;
        document.title = 'Rakip aranıyor' + '.'.repeat(dots);
    }, 500);
</script>

{% endblock %}